# YAML åˆå¹¶å·¥å…· MCP æœåŠ¡å™¨ä½¿ç”¨æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬é¡¹ç›®å·²é…ç½®å®Œæ•´çš„ MCP (Model Context Protocol) æ”¯æŒï¼Œå®ç°è‡ªåŠ¨åŒ– YAML é…ç½®åˆå¹¶ã€ç¯å¢ƒæ­å»ºå’Œæ–‡ä»¶æ“ä½œã€‚

## ğŸ“‹ MCP æœåŠ¡å™¨é…ç½®

### å·²å¯ç”¨çš„ MCP æœåŠ¡å™¨

**yaml-merger-mcp**: è‡ªå®šä¹‰ MCP æœåŠ¡å™¨ï¼Œæä¾›ä»¥ä¸‹å·¥å…·ï¼š

| å·¥å…·åç§° | åŠŸèƒ½æè¿° | å‚æ•° |
|---------|---------|------|
| `read_file` | è¯»å–æ–‡ä»¶å†…å®¹ | `path` - æ–‡ä»¶è·¯å¾„ |
| `write_file` | å†™å…¥æ–‡ä»¶å†…å®¹ | `path`, `content` |
| `list_files` | åˆ—å‡ºç›®å½•æ–‡ä»¶ | `path` - ç›®å½•è·¯å¾„ |
| `execute_command` | æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ | `command`, `args`, `cwd` |
| `validate_yaml` | éªŒè¯YAMLè¯­æ³• | `path` - YAMLæ–‡ä»¶è·¯å¾„ |
| `merge_yaml_configs` | **åˆå¹¶YAMLé…ç½®** | `input_files[]`, `output_file`, `options` |
| `create_directory` | åˆ›å»ºç›®å½• | `path` - ç›®å½•è·¯å¾„ |

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. åŸºäº MCP çš„è‡ªåŠ¨åŒ–åˆå¹¶

```json
{
  "name": "merge_yaml_configs",
  "arguments": {
    "input_files": ["template.yaml", "user.yaml"],
    "output_file": "merged.yaml",
    "options": {
      "verbose": true,
      "array_strategy": "append",
      "compatibility": false
    }
  }
}
```

### 2. æŠ€èƒ½æ–‡æ¡£é©±åŠ¨çš„æ“ä½œ

æ ¹æ®é¡¹ç›®æŠ€èƒ½æ–‡æ¡£ï¼Œä»¥ä¸‹æ“ä½œä¼šè‡ªåŠ¨è°ƒç”¨ MCPï¼š

#### ğŸ”§ `yaml-merge-auto-execute-mcp` æŠ€èƒ½
- **è§¦å‘**: "è‡ªåŠ¨æ‰§è¡Œ YAML é…ç½®åˆå¹¶"
- **æµç¨‹**:
  1. æ£€æŸ¥è¾“å…¥æ–‡ä»¶ â†’ 2. åˆ›å»ºè¾“å‡ºç›®å½• â†’ 3. æ‰§è¡Œåˆå¹¶å‘½ä»¤ â†’ 4. éªŒè¯ç»“æœ â†’ 5. ç”ŸæˆæŠ¥å‘Š

#### ğŸ› ï¸ `yaml-project-env-setup-mcp` æŠ€èƒ½
- **è§¦å‘**: "æ­å»ºé¡¹ç›®è¿è¡Œç¯å¢ƒ"
- **æµç¨‹**:
  1. æ£€æŸ¥é¡¹ç›®æ–‡ä»¶ â†’ 2. æ ¡éªŒPythonç‰ˆæœ¬ â†’ 3. å®‰è£…ä¾èµ– â†’ 4. éªŒè¯å®‰è£…

## ğŸ“ é¡¹ç›®ç»“æ„

```
YAML-Config-Merger-Tool/
â”œâ”€â”€ .mcp.yaml                    # MCP é…ç½®æ–‡ä»¶
â”œâ”€â”€ mcp-server.py                # è‡ªå®šä¹‰ MCP æœåŠ¡å™¨
â”œâ”€â”€ yaml_merger.py              # CLI åˆå¹¶å·¥å…·
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”œâ”€â”€ venv/                       # è™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ skills/                     # æŠ€èƒ½æ–‡æ¡£
â”‚   â”œâ”€â”€ yaml-cli-command-generator.skill.md
â”‚   â”œâ”€â”€ yaml-merge-auto-execute-mcp.skill.md
â”‚   â””â”€â”€ yaml-project-env-setup-mcp.skill.md
â””â”€â”€ test-*.yaml                # æµ‹è¯•æ–‡ä»¶
```

## ğŸ® å®é™…ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: è‡ªåŠ¨åˆå¹¶é…ç½®
ç”¨æˆ·è¯·æ±‚: *"è‡ªåŠ¨æ‰§è¡Œ YAML é…ç½®åˆå¹¶ï¼Œåˆå¹¶ template.yaml å’Œ user.yaml åˆ° result.yaml"*

MCP è‡ªåŠ¨æ‰§è¡Œ:
1. âœ… æ£€æŸ¥è¾“å…¥æ–‡ä»¶å­˜åœ¨æ€§
2. âœ… åˆ›å»ºè¾“å‡ºç›®å½•
3. âœ… æ‰§è¡Œåˆå¹¶å‘½ä»¤: `python yaml_merger.py --input template.yaml user.yaml --output result.yaml`
4. âœ… éªŒè¯è¾“å‡ºæ–‡ä»¶è¯­æ³•
5. âœ… ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Š

### ç¤ºä¾‹2: ç¯å¢ƒæ­å»º
ç”¨æˆ·è¯·æ±‚: *"å¸®æˆ‘æ­å»ºé¡¹ç›®çš„è¿è¡Œç¯å¢ƒ"*

MCP è‡ªåŠ¨æ‰§è¡Œ:
1. âœ… æ£€æŸ¥ requirements.txt å’Œ yaml_merger.py
2. âœ… æ ¡éªŒ Python ç‰ˆæœ¬ â‰¥3.7
3. âœ… æ‰§è¡Œ: `pip install -r requirements.txt`
4. âœ… éªŒè¯ PyYAML å®‰è£…æˆåŠŸ
5. âœ… è¾“å‡ºç¯å¢ƒæ­å»ºæŠ¥å‘Š

## âš™ï¸ é…ç½®æ–‡ä»¶

### `.claude.json` é¡¹ç›®é…ç½®
```json
{
  "mcpServers": {
    "yaml-merger-mcp": {
      "command": "bash",
      "args": ["-c", "cd ... && source venv/bin/activate && python3 mcp-server.py"],
      "enabledMcpjsonServers": ["yaml-merger-mcp"]
    }
  }
}
```

### `.mcp.yaml` å·¥å…·ç»‘å®šé…ç½®
- å®šä¹‰äº†æŠ€èƒ½æ–‡æ¡£ä¸ MCP å·¥å…·çš„æ˜ å°„å…³ç³»
- é…ç½®å‘½ä»¤æ¨¡æ¿å’Œçº¦æŸæ¡ä»¶
- æ”¯æŒæœ€å¤š5ä¸ªæ–‡ä»¶åˆå¹¶ï¼Œå•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡10MB

## ğŸ”§ æ•…éšœæ’é™¤

### MCP æœåŠ¡å™¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate
python3 mcp-server.py

# æ£€æŸ¥ä¾èµ–
pip list | grep PyYAML
```

### åˆå¹¶å¤±è´¥
1. æ£€æŸ¥è¾“å…¥æ–‡ä»¶ YAML è¯­æ³•
2. ç¡®è®¤è¾“å‡ºç›®å½•æƒé™
3. éªŒè¯è™šæ‹Ÿç¯å¢ƒæ¿€æ´»

## ğŸ“ æ³¨æ„äº‹é¡¹

- **å®‰å…¨**: MCP æœåŠ¡å™¨ä»…æ‰§è¡Œå®‰å…¨å‘½ä»¤ï¼Œç¦ç”¨ `sudo` ç­‰é«˜å±æ“ä½œ
- **æ€§èƒ½**: é™åˆ¶åˆå¹¶æ–‡ä»¶æ•°é‡(â‰¤5)å’Œå¤§å°(â‰¤10MB)é˜²æ­¢è¶…æ—¶
- **å…¼å®¹**: æ”¯æŒæŠ€èƒ½æ–‡æ¡£è§„èŒƒï¼Œç¡®ä¿æ“ä½œä¸€è‡´æ€§
- **æƒé™**: éœ€è¦ç”¨æˆ·æˆäºˆç»ˆç«¯å’Œæ–‡ä»¶è®¿é—®æƒé™

---

ğŸ‰ **MCP é…ç½®å®Œæˆï¼** ç°åœ¨å¯ä»¥äº«å—å…¨è‡ªåŠ¨åŒ–çš„ YAML é…ç½®åˆå¹¶ä½“éªŒï¼