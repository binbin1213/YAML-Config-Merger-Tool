<div class="flex flex-col h-screen">
  <main class="w-full flex flex-col bg-slate-950 flex-1 min-h-0 h-full">
    <header class="h-16 border-b border-[rgba(100,100,100,0.2)] bg-[rgba(20,20,25,0.7)] backdrop-blur-[10px] flex items-center px-6 justify-between flex-shrink-0">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 flex items-center justify-center">
          <img src="./favicon.svg" alt="YAML Config Merger Tool" class="w-8 h-8">
        </div>
        <h1 class="font-bold text-xl tracking-tight text-slate-100">
          YAML Config Merger
        </h1>
      </div>
      <div class="flex items-center gap-4">
        <button type="button" (click)="toggleHelp()" class="text-sm text-slate-400 hover:text-white transition-colors">使用说明</button>
        <div class="h-4 w-px bg-slate-800"></div>
        <span class="text-xs px-2 py-1 rounded bg-slate-800 text-slate-400 border border-slate-700">v1.0.0</span>
      </div>
    </header>
    
    <div class="flex-1 p-4 h-full">
      <app-config-merger></app-config-merger>
    </div>

    @if (helpOpen()) {
      <div class="fixed inset-0 z-50">
        <button type="button" class="absolute inset-0 bg-black/60" (click)="closeHelp()" aria-label="关闭使用说明"></button>
        <div role="dialog" aria-modal="true" aria-labelledby="help-title" class="fixed left-1/2 top-1/2 w-[min(720px,calc(100vw-2rem))] max-h-[calc(100vh-2rem)] -translate-x-1/2 -translate-y-1/2 overflow-auto rounded-xl border border-slate-700 bg-slate-950 shadow-2xl">
          <div class="flex items-start justify-between gap-4 border-b border-slate-800 px-6 py-4">
            <div class="min-w-0">
              <h2 id="help-title" class="text-base font-semibold text-slate-100">使用说明</h2>
              <p class="mt-1 text-sm text-slate-400">将订阅节点合并到模版分流规则，并下载最终 YAML。</p>
            </div>
            <button type="button" (click)="closeHelp()" class="shrink-0 rounded-md px-2 py-1 text-sm text-slate-400 hover:text-white hover:bg-slate-800/60 transition-colors">关闭</button>
          </div>

          <div class="px-6 py-4 text-sm text-slate-200">
            <div class="space-y-4">
              <div>
                <div class="font-medium text-slate-100">1. 选择模版</div>
                <div class="mt-1 text-slate-400">左侧可上传或直接使用内置模版。</div>
              </div>
              <div>
                <div class="font-medium text-slate-100">2. 导入订阅</div>
                <div class="mt-1 text-slate-400">中间粘贴或上传你的订阅 YAML（包含节点/代理提供者等）。</div>
              </div>
              <div>
                <div class="font-medium text-slate-100">3. 模式说明</div>
                <div class="mt-1 text-slate-400">Smart模式：保留 Smart/正则能力，生成的配置更接近原模版，需支持 Smart 的内核。</div>
                <div class="mt-1 text-slate-400">兼容模式：将 Smart/正则在浏览器中计算为静态 proxies 列表，并移除相关字段，兼容更多客户端。</div>
              </div>
              <div>
                <div class="font-medium text-slate-100">注意事项</div>
                <div class="mt-1 text-slate-400">Smart模式关闭“兼容模式”开关后生效；若客户端不支持 Smart/正则，可能无法工作。</div>
                <div class="mt-1 text-slate-400">兼容模式开启后会把动态规则固化，后续新增节点需重新合并生成。</div>
                <div class="mt-1 text-slate-400">如果仅上传订阅不含 proxy-providers，模版中占位的 proxy-providers 会被自动移除。</div>
              </div>
              <div>
                <div class="font-medium text-slate-100">4. 下载结果</div>
                <div class="mt-1 text-slate-400">点击“刷新合并”后可“下载 YAML”，导入客户端即可使用。</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    }
  </main>
  <footer class="h-12 border-t border-slate-800 bg-slate-950 backdrop-blur flex items-center px-6 justify-center flex-shrink-0">
    <div class="flex items-center gap-4">
      <span class="text-xs text-slate-400">YAML Config Merger Tool &copy; 2025</span>
      <a href="https://github.com/binbin1213/YAML-Config-Merger-Tool" target="_blank" class="text-xs text-slate-400 hover:text-white transition-colors underline">GitHub</a>
    </div>
  </footer>
</div>
